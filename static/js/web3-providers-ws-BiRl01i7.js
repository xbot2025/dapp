import{W as i}from"./isomorphic-ws-XxKvb2PZ.js";import{x as c}from"./web3-errors-DMH_yRvG.js";import{S as r,i as a}from"./web3-utils-4vEJ-nRv.js";class v extends r{constructor(e,n,t){super(e,n,t)}_validateProviderPath(e){return typeof e=="string"&&/^ws(s)?:\/\//i.test(e)}getStatus(){if(this._socketConnection&&!a(this._socketConnection))switch(this._socketConnection.readyState){case this._socketConnection.CONNECTING:return"connecting";case this._socketConnection.OPEN:return"connected";default:return"disconnected"}return"disconnected"}_openSocketConnection(){this._socketConnection=new i(this._socketPath,void 0,this._socketOptions&&Object.keys(this._socketOptions).length===0?void 0:this._socketOptions)}_closeSocketConnection(e,n){var t;(t=this._socketConnection)===null||t===void 0||t.close(e,n)}_sendToSocket(e){var n;if(this.getStatus()==="disconnected")throw new c;(n=this._socketConnection)===null||n===void 0||n.send(JSON.stringify(e))}_parseResponses(e){return this.chunkResponseParser.parseResponse(e.data)}_addSocketListeners(){var e,n,t,o;(e=this._socketConnection)===null||e===void 0||e.addEventListener("open",this._onOpenHandler),(n=this._socketConnection)===null||n===void 0||n.addEventListener("message",this._onMessageHandler),(t=this._socketConnection)===null||t===void 0||t.addEventListener("close",s=>this._onCloseHandler(s)),(o=this._socketConnection)===null||o===void 0||o.addEventListener("error",this._onErrorHandler)}_removeSocketListeners(){var e,n,t;(e=this._socketConnection)===null||e===void 0||e.removeEventListener("message",this._onMessageHandler),(n=this._socketConnection)===null||n===void 0||n.removeEventListener("open",this._onOpenHandler),(t=this._socketConnection)===null||t===void 0||t.removeEventListener("close",this._onCloseHandler)}_onCloseEvent(e){var n;!this._reconnectOptions.autoReconnect||[1e3,1001].includes(e.code)&&e.wasClean?(this._clearQueues(e),this._removeSocketListeners(),this._onDisconnect(e.code,e.reason),(n=this._socketConnection)===null||n===void 0||n.removeEventListener("error",this._onErrorHandler)):this._reconnect()}}export{v as W};
